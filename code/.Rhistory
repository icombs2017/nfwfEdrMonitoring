rownames_to_column(var = 'samples') %>%
select(samples) %>%
separate(col = samples, into = c("site", "timePoint", "species"), sep = "_", remove = FALSE)
set.seed(3008)
dist <- vegdist(ecoMat, method = 'bray')
nmds <- metaMDS(dist)
scores(nmds) %>%
as_tibble(rownames = 'samples') %>%
inner_join(., samples_lookup, by = 'samples') %>%
ggplot(aes(x = NMDS1, y = NMDS2, shape = treatment, color = reef))+
geom_point()
scores(nmds) %>%
as_tibble(rownames = 'samples') %>%
inner_join(., samples_lookup, by = 'samples') %>%
ggplot(aes(x = NMDS1, y = NMDS2, shape = timePoint, color = species))+
geom_point()
vpiMat1 <- vpiMat
samplesLookupPerm <- vpiMat1 %>%
rownames_to_column(var = "samples") %>%
select(samples) %>%
separate(col = samples, into = c("site", "timePoint", "species"), sep = "_", remove = FALSE) %>%
column_to_rownames(var = "samples")
vpiDist <- vegdist(vpiMat1, method = 'bray')
distPerm <- adonis2(vpiDist ~ site*timePoint*species, data = samplesLookupPerm, permutations = 9999, method = 'bray')
distPerm
distPerm <- adonis2(vpiDist ~ timePoint*species, data = samplesLookupPerm, permutations = 9999, method = 'bray')
distPerm
distPermTab = data.frame("Test" = "PERMANOVA", "Comparison" = "Class", "df" = distPerm[["aov.tab"]][["Df"]][[1]],"Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[1]], "p.value" = distPerm[["aov.tab"]][["Pr(>F)"]][[1]]) %>%
add_row("Test" = " ", "Comparison" = "Time", "df" = distPerm[["aov.tab"]][["Df"]][[2]], "Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[2]], "p.value" = distPerm[["aov.tab"]][["Pr(>F)"]][[2]]) %>%
add_row("Test" = " ", "Comparison" = "Treatment", "df" = distPerm[["aov.tab"]][["Df"]][[3]], "Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[3]], "p.value" = distPerm[["aov.tab"]][["Pr(>F)"]][[3]]) %>%
add_row("Test" = " ", "Comparison" = "Class:Time", "df" = distPerm[["aov.tab"]][["Df"]][[4]], "Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[4]], "p.value" = distPerm[["aov.tab"]][["Pr(>F)"]][[4]]) %>%
add_row("Test" = " ", "Comparison" = "Class:Treatment", "df" = distPerm[["aov.tab"]][["Df"]][[5]], "Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[5]], "p.value" = distPerm[["aov.tab"]][["Pr(>F)"]][[5]]) %>%
add_row("Test" = " ", "Comparison" = "Time:Treatment", "df" = distPerm[["aov.tab"]][["Df"]][[6]], "Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[6]], "p.value" = distPerm[["aov.tab"]][["Pr(>F)"]][[6]]) %>%
add_row("Test" = " ", "Comparison" = "Class:Time:Treatment", "df" = distPerm[["aov.tab"]][["Df"]][[7]], "Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[7]], "p.value" = distPerm[["aov.tab"]][["Pr(>F)"]][[7]])
distPerm
View(distPerm)
distPermTab <- distPerm %>%
mutate_if(is.numeric, round, digits = 3) %>%
mutate(p.value = replace(p.value, p.value >= 0.05, "ns")) %>%
mutate(p.value = replace(p.value, p.value < 0.001, "< 0.001")) %>%
mutate_if(is.character, str_replace_all, pattern = "-", replacement = "–") %>%
flextable() %>%
set_header_labels(Data.set = "Data set") %>%
flextable::compose(part = "header", j = "df", value = as_paragraph("df")) %>%
flextable::compose(part = "header", j = "Pseudo.F", value = as_paragraph("Pseudo-F")) %>%
flextable::compose(part = "header", j = "p.value", value = as_paragraph(as_i("p"), "-value")) %>%
autofit() %>%
font(fontname = "Times New Roman", part = "all") %>%
fontsize(size = 12, part = "all") %>%
bold(part = "header") %>%
colformat_num(j = 'df', digits = 2) %>%
colformat_num(j = "Pseudo.F", digits = 2) %>%
colformat_num(j = "p.value", digits = 4, na_str = "ns") %>%
align_nottext_col(align = "center", header = TRUE, footer = TRUE) %>%
align(align = "center", j = "p.value")
View(dist_tbl)
View(distPerm)
names(distPerm)
distPermTab = data.frame("Test" = "PERMANOVA", "Comparison" = "Class", "df" = distPerm[["aov.tab"]][["Df"]][[1]],"Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[1]], "`Pr(>F)`" = distPerm[["aov.tab"]][["`Pr(>F)`"]][[1]]) %>%
add_row("Test" = " ", "Comparison" = "Time", "df" = distPerm[["aov.tab"]][["Df"]][[2]], "Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[2]], "`Pr(>F)`" = distPerm[["aov.tab"]][["`Pr(>F)`"]][[2]]) %>%
add_row("Test" = " ", "Comparison" = "Treatment", "df" = distPerm[["aov.tab"]][["Df"]][[3]], "Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[3]], "`Pr(>F)`" = distPerm[["aov.tab"]][["`Pr(>F)`"]][[3]]) %>%
add_row("Test" = " ", "Comparison" = "Class:Time", "df" = distPerm[["aov.tab"]][["Df"]][[4]], "Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[4]], "`Pr(>F)`" = distPerm[["aov.tab"]][["`Pr(>F)`"]][[4]]) %>%
add_row("Test" = " ", "Comparison" = "Class:Treatment", "df" = distPerm[["aov.tab"]][["Df"]][[5]], "Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[5]], "`Pr(>F)`" = distPerm[["aov.tab"]][["`Pr(>F)`"]][[5]]) %>%
add_row("Test" = " ", "Comparison" = "Time:Treatment", "df" = distPerm[["aov.tab"]][["Df"]][[6]], "Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[6]], "`Pr(>F)`" = distPerm[["aov.tab"]][["`Pr(>F)`"]][[6]]) %>%
add_row("Test" = " ", "Comparison" = "Class:Time:Treatment", "df" = distPerm[["aov.tab"]][["Df"]][[7]], "Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[7]], "`Pr(>F)`" = distPerm[["aov.tab"]][["`Pr(>F)`"]][[7]]) %>%
distPermTab <- distPerm %>%
mutate_if(is.numeric, round, digits = 3) %>%
mutate(`Pr(>F)` = replace(`Pr(>F)`, `Pr(>F)` >= 0.05, "ns")) %>%
mutate(`Pr(>F)` = replace(`Pr(>F)`, `Pr(>F)` < 0.001, "< 0.001")) %>%
mutate_if(is.character, str_replace_all, pattern = "-", replacement = "–") %>%
flextable() %>%
set_header_labels(Data.set = "Data set") %>%
flextable::compose(part = "header", j = "df", value = as_paragraph("df")) %>%
flextable::compose(part = "header", j = "Pseudo.F", value = as_paragraph("Pseudo-F")) %>%
flextable::compose(part = "header", j = "`Pr(>F)`", value = as_paragraph(as_i("p"), "-value")) %>%
autofit() %>%
font(fontname = "Times New Roman", part = "all") %>%
fontsize(size = 12, part = "all") %>%
bold(part = "header") %>%
colformat_num(j = 'df', digits = 2) %>%
colformat_num(j = "Pseudo.F", digits = 2) %>%
colformat_num(j = "`Pr(>F)`", digits = 4, na_str = "ns") %>%
align_nottext_col(align = "center", header = TRUE, footer = TRUE) %>%
align(align = "center", j = "`Pr(>F)`")
distPermTab = data.frame("Test" = "PERMANOVA", "Comparison" = "Class", "df" = distPerm[["aov.tab"]][["Df"]][[1]],"Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[1]], "`Pr(>F)`" = distPerm[["aov.tab"]][["`Pr(>F)`"]][[1]]) %>%
add_row("Test" = " ", "Comparison" = "Time", "df" = distPerm[["aov.tab"]][["Df"]][[2]], "Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[2]], "`Pr(>F)`" = distPerm[["aov.tab"]][["`Pr(>F)`"]][[2]]) %>%
add_row("Test" = " ", "Comparison" = "Treatment", "df" = distPerm[["aov.tab"]][["Df"]][[3]], "Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[3]], "`Pr(>F)`" = distPerm[["aov.tab"]][["`Pr(>F)`"]][[3]]) %>%
add_row("Test" = " ", "Comparison" = "Class:Time", "df" = distPerm[["aov.tab"]][["Df"]][[4]], "Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[4]], "`Pr(>F)`" = distPerm[["aov.tab"]][["`Pr(>F)`"]][[4]]) %>%
add_row("Test" = " ", "Comparison" = "Class:Treatment", "df" = distPerm[["aov.tab"]][["Df"]][[5]], "Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[5]], "`Pr(>F)`" = distPerm[["aov.tab"]][["`Pr(>F)`"]][[5]]) %>%
add_row("Test" = " ", "Comparison" = "Time:Treatment", "df" = distPerm[["aov.tab"]][["Df"]][[6]], "Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[6]], "`Pr(>F)`" = distPerm[["aov.tab"]][["`Pr(>F)`"]][[6]]) %>%
add_row("Test" = " ", "Comparison" = "Class:Time:Treatment", "df" = distPerm[["aov.tab"]][["Df"]][[7]], "Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[7]], "`Pr(>F)`" = distPerm[["aov.tab"]][["`Pr(>F)`"]][[7]]) %>%
distPermTab <- distPerm %>%
mutate_if(is.numeric, round, digits = 3) %>%
mutate(`Pr(>F)` = replace(`Pr(>F)`, `Pr(>F)` >= 0.05, "ns")) %>%
mutate(`Pr(>F)` = replace(`Pr(>F)`, `Pr(>F)` < 0.001, "< 0.001")) %>%
mutate_if(is.character, str_replace_all, pattern = "-", replacement = "–") %>%
flextable() %>%
set_header_labels(Data.set = "Data set") %>%
flextable::compose(part = "header", j = "df", value = as_paragraph("df")) %>%
flextable::compose(part = "header", j = "Pseudo.F", value = as_paragraph("Pseudo-F")) %>%
flextable::compose(part = "header", j = "`Pr(>F)`", value = as_paragraph(as_i("p"), "-value")) %>%
autofit() %>%
font(fontname = "Times New Roman", part = "all") %>%
fontsize(size = 12, part = "all") %>%
bold(part = "header") %>%
colformat_num(j = 'df', digits = 2) %>%
colformat_num(j = "Pseudo.F", digits = 2) %>%
colformat_num(j = "`Pr(>F)`", digits = 4, na_str = "ns") %>%
align_nottext_col(align = "center", header = TRUE, footer = TRUE) %>%
align(align = "center", j = "`Pr(>F)`")
distPermTab = data.frame("Test" = "PERMANOVA", "Comparison" = "Class", "df" = distPerm[["aov.tab"]][["Df"]][[1]],"Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[1]], "`Pr(>F)`" = distPerm[["aov.tab"]][["`Pr(>F)`"]][[1]]) %>%
add_row("Test" = " ", "Comparison" = "Time", "df" = distPerm[["aov.tab"]][["Df"]][[2]], "Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[2]], "`Pr(>F)`" = distPerm[["aov.tab"]][["`Pr(>F)`"]][[2]]) %>%
add_row("Test" = " ", "Comparison" = "Treatment", "df" = distPerm[["aov.tab"]][["Df"]][[3]], "Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[3]], "`Pr(>F)`" = distPerm[["aov.tab"]][["`Pr(>F)`"]][[3]]) %>%
add_row("Test" = " ", "Comparison" = "Class:Time", "df" = distPerm[["aov.tab"]][["Df"]][[4]], "Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[4]], "`Pr(>F)`" = distPerm[["aov.tab"]][["`Pr(>F)`"]][[4]]) %>%
add_row("Test" = " ", "Comparison" = "Class:Treatment", "df" = distPerm[["aov.tab"]][["Df"]][[5]], "Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[5]], "`Pr(>F)`" = distPerm[["aov.tab"]][["`Pr(>F)`"]][[5]]) %>%
add_row("Test" = " ", "Comparison" = "Time:Treatment", "df" = distPerm[["aov.tab"]][["Df"]][[6]], "Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[6]], "`Pr(>F)`" = distPerm[["aov.tab"]][["`Pr(>F)`"]][[6]]) %>%
add_row("Test" = " ", "Comparison" = "Class:Time:Treatment", "df" = distPerm[["aov.tab"]][["Df"]][[7]], "Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[7]], "`Pr(>F)`" = distPerm[["aov.tab"]][["`Pr(>F)`"]][[7]]) %>%
distPermTab <- distPerm %>%
mutate_if(is.numeric, round, digits = 3) %>%
mutate(`Pr(>F)` = replace(`Pr(>F)`, `Pr(>F)` >= 0.05, "ns")) %>%
mutate(`Pr(>F)` = replace(`Pr(>F)`, `Pr(>F)` < 0.001, "< 0.001")) %>%
mutate_if(is.character, str_replace_all, pattern = "-", replacement = "–") %>%
flextable() %>%
set_header_labels(Data.set = "Data set") %>%
flextable::compose(part = "header", j = "df", value = as_paragraph("df")) %>%
flextable::compose(part = "header", j = "Pseudo.F", value = as_paragraph("Pseudo-F")) %>%
flextable::compose(part = "header", j = "`Pr(>F)`", value = as_paragraph(as_i("p"), "-value")) %>%
autofit() %>%
font(fontname = "Times New Roman", part = "all") %>%
fontsize(size = 12, part = "all") %>%
bold(part = "header") %>%
colformat_num(j = 'df', digits = 2) %>%
colformat_num(j = "Pseudo.F", digits = 2) %>%
colformat_num(j = "`Pr(>F)`", digits = 4, na_str = "ns") %>%
align_nottext_col(align = "center", header = TRUE, footer = TRUE) %>%
align(align = "center", j = "`Pr(>F)`")
distPermTab <- distPerm %>%
mutate_if(is.numeric, round, digits = 3) %>%
mutate(`Pr(>F)` = replace(`Pr(>F)`, `Pr(>F)` >= 0.05, "ns")) %>%
mutate(`Pr(>F)` = replace(`Pr(>F)`, `Pr(>F)` < 0.001, "< 0.001")) %>%
mutate_if(is.character, str_replace_all, pattern = "-", replacement = "–") %>%
flextable() %>%
set_header_labels(Data.set = "Data set") %>%
flextable::compose(part = "header", j = "df", value = as_paragraph("df")) %>%
flextable::compose(part = "header", j = "Pseudo.F", value = as_paragraph("Pseudo-F")) %>%
flextable::compose(part = "header", j = "`Pr(>F)`", value = as_paragraph(as_i("p"), "-value")) %>%
autofit() %>%
font(fontname = "Times New Roman", part = "all") %>%
fontsize(size = 12, part = "all") %>%
bold(part = "header") %>%
colformat_num(j = 'df', digits = 2) %>%
colformat_num(j = "Pseudo.F", digits = 2) %>%
colformat_num(j = "`Pr(>F)`", digits = 4, na_str = "ns") %>%
align_nottext_col(align = "center", header = TRUE, footer = TRUE) %>%
align(align = "center", j = "`Pr(>F)`")
distPermTab <- distPerm %>%
rename("p.value" = "Pr(>F)")
View(distPermTab)
distPermTab <- distPerm %>%
rename("`Pr(>F)`" = "p.value")
distPermTab <- distPerm %>%
rename("p.value" = "`Pr(>F)`")
distPermTab <- distPerm %>%
rename("p.value" = "Pr(>F)")
istPermTab <- distPerm %>%
rename("p.value" = "Pr(>F)") %>%
mutate_if(is.numeric, round, digits = 3) %>%
mutate(p.value = replace(p.value, p.value >= 0.05, "ns")) %>%
mutate(p.value = replace(p.value, p.value < 0.001, "< 0.001")) %>%
mutate_if(is.character, str_replace_all, pattern = "-", replacement = "–") %>%
flextable() %>%
set_header_labels(Data.set = "Data set") %>%
flextable::compose(part = "header", j = "df", value = as_paragraph("df")) %>%
flextable::compose(part = "header", j = "Pseudo.F", value = as_paragraph("Pseudo-F")) %>%
flextable::compose(part = "header", j = "p.value", value = as_paragraph(as_i("p"), "-value")) %>%
autofit() %>%
font(fontname = "Times New Roman", part = "all") %>%
fontsize(size = 12, part = "all") %>%
bold(part = "header") %>%
colformat_num(j = 'df', digits = 2) %>%
colformat_num(j = "Pseudo.F", digits = 2) %>%
colformat_num(j = "p.value", digits = 4, na_str = "ns") %>%
align_nottext_col(align = "center", header = TRUE, footer = TRUE) %>%
align(align = "center", j = "p.value")
distPermTab = data.frame("Test" = "PERMANOVA", "Comparison" = "Class", "df" = distPerm[["aov.tab"]][["Df"]][[1]],"Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[1]], "p.value" = distPerm[["aov.tab"]][["Pr(>F)"]][[1]]) %>%
add_row("Test" = " ", "Comparison" = "Time", "df" = distPerm[["aov.tab"]][["Df"]][[2]], "Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[2]], "p.value" = distPerm[["aov.tab"]][["Pr(>F)"]][[2]]) %>%
add_row("Test" = " ", "Comparison" = "Treatment", "df" = distPerm[["aov.tab"]][["Df"]][[3]], "Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[3]], "p.value" = distPerm[["aov.tab"]][["Pr(>F)"]][[3]]) %>%
add_row("Test" = " ", "Comparison" = "Class:Time", "df" = distPerm[["aov.tab"]][["Df"]][[4]], "Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[4]], "p.value" = distPerm[["aov.tab"]][["Pr(>F)"]][[4]]) %>%
add_row("Test" = " ", "Comparison" = "Class:Treatment", "df" = distPerm[["aov.tab"]][["Df"]][[5]], "Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[5]], "p.value" = distPerm[["aov.tab"]][["Pr(>F)"]][[5]]) %>%
add_row("Test" = " ", "Comparison" = "Time:Treatment", "df" = distPerm[["aov.tab"]][["Df"]][[6]], "Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[6]], "p.value" = distPerm[["aov.tab"]][["Pr(>F)"]][[6]]) %>%
add_row("Test" = " ", "Comparison" = "Class:Time:Treatment", "df" = distPerm[["aov.tab"]][["Df"]][[7]], "Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[7]], "p.value" = distPerm[["aov.tab"]][["Pr(>F)"]][[7]]) %>%
distPermTab <- distPerm %>%
rename("p.value" = "Pr(>F)") %>%
mutate_if(is.numeric, round, digits = 3) %>%
mutate(p.value = replace(p.value, p.value >= 0.05, "ns")) %>%
mutate(p.value = replace(p.value, p.value < 0.001, "< 0.001")) %>%
mutate_if(is.character, str_replace_all, pattern = "-", replacement = "–") %>%
flextable() %>%
set_header_labels(Data.set = "Data set") %>%
flextable::compose(part = "header", j = "df", value = as_paragraph("df")) %>%
flextable::compose(part = "header", j = "Pseudo.F", value = as_paragraph("Pseudo-F")) %>%
flextable::compose(part = "header", j = "p.value", value = as_paragraph(as_i("p"), "-value")) %>%
autofit() %>%
font(fontname = "Times New Roman", part = "all") %>%
fontsize(size = 12, part = "all") %>%
bold(part = "header") %>%
colformat_num(j = 'df', digits = 2) %>%
colformat_num(j = "Pseudo.F", digits = 2) %>%
colformat_num(j = "p.value", digits = 4, na_str = "ns") %>%
align_nottext_col(align = "center", header = TRUE, footer = TRUE) %>%
align(align = "center", j = "p.value")
distPermTab = data.frame("Test" = "PERMANOVA", "Comparison" = "Class", "df" = distPerm[["aov.tab"]][["Df"]][[1]],"Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[1]], "p.value" = distPerm[["aov.tab"]][["Pr(>F)"]][[1]]) %>%
add_row("Test" = " ", "Comparison" = "Time", "df" = distPerm[["aov.tab"]][["Df"]][[2]], "Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[2]], "p.value" = distPerm[["aov.tab"]][["Pr(>F)"]][[2]]) %>%
add_row("Test" = " ", "Comparison" = "Treatment", "df" = distPerm[["aov.tab"]][["Df"]][[3]], "Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[3]], "p.value" = distPerm[["aov.tab"]][["Pr(>F)"]][[3]]) %>%
add_row("Test" = " ", "Comparison" = "Class:Time", "df" = distPerm[["aov.tab"]][["Df"]][[4]], "Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[4]], "p.value" = distPerm[["aov.tab"]][["Pr(>F)"]][[4]]) %>%
add_row("Test" = " ", "Comparison" = "Class:Treatment", "df" = distPerm[["aov.tab"]][["Df"]][[5]], "Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[5]], "p.value" = distPerm[["aov.tab"]][["Pr(>F)"]][[5]]) %>%
add_row("Test" = " ", "Comparison" = "Time:Treatment", "df" = distPerm[["aov.tab"]][["Df"]][[6]], "Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[6]], "p.value" = distPerm[["aov.tab"]][["Pr(>F)"]][[6]]) %>%
add_row("Test" = " ", "Comparison" = "Class:Time:Treatment", "df" = distPerm[["aov.tab"]][["Df"]][[7]], "Pseudo.F" = distPerm[["aov.tab"]][["F.Model"]][[7]], "p.value" = distPerm[["aov.tab"]][["Pr(>F)"]][[7]]) %>%
distPermTab <- distPerm %>%
rename("p.value" = "Pr(>F)") %>%
mutate_if(is.numeric, round, digits = 3) %>%
mutate(p.value = replace(p.value, p.value >= 0.05, "ns")) %>%
mutate(p.value = replace(p.value, p.value < 0.001, "< 0.001")) %>%
mutate_if(is.character, str_replace_all, pattern = "-", replacement = "–") %>%
flextable() %>%
set_header_labels(Data.set = "Data set") %>%
flextable::compose(part = "header", j = "df", value = as_paragraph("df")) %>%
flextable::compose(part = "header", j = "Pseudo.F", value = as_paragraph("Pseudo-F")) %>%
flextable::compose(part = "header", j = "p.value", value = as_paragraph(as_i("p"), "-value")) %>%
autofit() %>%
font(fontname = "Times New Roman", part = "all") %>%
fontsize(size = 12, part = "all") %>%
bold(part = "header") %>%
colformat_num(j = 'df', digits = 2) %>%
colformat_num(j = "Pseudo.F", digits = 2) %>%
colformat_num(j = "p.value", digits = 4, na_str = "ns") %>%
align_nottext_col(align = "center", header = TRUE, footer = TRUE) %>%
align(align = "center", j = "p.value")
distPermTab <- distPerm %>%
rename("p.value" = "Pr(>F)") %>%
mutate_if(is.numeric, round, digits = 3) %>%
mutate(p.value = replace(p.value, p.value >= 0.05, "ns")) %>%
mutate(p.value = replace(p.value, p.value < 0.001, "< 0.001")) %>%
mutate_if(is.character, str_replace_all, pattern = "-", replacement = "–") %>%
flextable() %>%
set_header_labels(Data.set = "Data set") %>%
flextable::compose(part = "header", j = "df", value = as_paragraph("df")) %>%
flextable::compose(part = "header", j = "Pseudo.F", value = as_paragraph("Pseudo-F")) %>%
flextable::compose(part = "header", j = "p.value", value = as_paragraph(as_i("p"), "-value")) %>%
autofit() %>%
font(fontname = "Times New Roman", part = "all") %>%
fontsize(size = 12, part = "all") %>%
bold(part = "header") %>%
colformat_num(j = 'df', digits = 2) %>%
colformat_num(j = "Pseudo.F", digits = 2) %>%
colformat_num(j = "p.value", digits = 4, na_str = "ns") %>%
align_nottext_col(align = "center", header = TRUE, footer = TRUE) %>%
align(align = "center", j = "p.value")
distPermTab <- distPerm %>%
rename("p.value" = "Pr(>F)") %>%
mutate_if(is.numeric, round, digits = 3) %>%
mutate(p.value = replace(p.value, p.value >= 0.05, "ns"))
distPermTab <- distPerm %>%
rename("p.value" = "Pr(>F)") %>%
mutate_if(is.numeric, round, digits = 3) %>%
mutate(p.value = replace(p.value, p.value >= 0.05, "ns")) %>%
mutate(p.value = replace(p.value, p.value < 0.001, "< 0.001")) %>%
mutate_if(is.character, str_replace_all, pattern = "-", replacement = "–") %>%
flextable()
distPermTab <- distPerm %>%
rename("p.value" = "Pr(>F)") %>%
mutate_if(is.numeric, round, digits = 3) %>%
mutate(p.value = replace(p.value, p.value >= 0.05, "ns")) %>%
mutate(p.value = replace(p.value, p.value < 0.001, "< 0.001")) %>%
mutate_if(is.character, str_replace_all, pattern = "-", replacement = "–") %>%
flextable() %>%
set_header_labels(Data.set = "Data set") %>%
flextable::compose(part = "header", j = "df", value = as_paragraph("df")) %>%
flextable::compose(part = "header", j = "Pseudo.F", value = as_paragraph("Pseudo-F"))
distPermTab <- distPerm %>%
rename("p.value" = "Pr(>F)") %>%
mutate_if(is.numeric, round, digits = 3) %>%
mutate(p.value = replace(p.value, p.value >= 0.05, "ns")) %>%
mutate(p.value = replace(p.value, p.value < 0.001, "< 0.001")) %>%
mutate_if(is.character, str_replace_all, pattern = "-", replacement = "–") %>%
flextable() %>%
set_header_labels(Data.set = "Data set")
distPermTab <- distPerm %>%
rename("p.value" = "Pr(>F)") %>%
mutate_if(is.numeric, round, digits = 3) %>%
mutate(p.value = replace(p.value, p.value >= 0.05, "ns")) %>%
mutate(p.value = replace(p.value, p.value < 0.001, "< 0.001")) %>%
mutate_if(is.character, str_replace_all, pattern = "-", replacement = "–") %>%
flextable() %>%
set_header_labels(Data.set = "Data set") %>%
flextable::compose(part = "header", j = "df", value = as_paragraph("df"))
distPerm
View(distPerm)
names(distPerm)
distPermTab <- distPerm %>%
rename("p.value" = "Pr(>F)") %>%
mutate_if(is.numeric, round, digits = 3) %>%
mutate(p.value = replace(p.value, p.value >= 0.05, "ns")) %>%
mutate(p.value = replace(p.value, p.value < 0.001, "< 0.001")) %>%
mutate_if(is.character, str_replace_all, pattern = "-", replacement = "–") %>%
flextable() %>%
set_header_labels(Data.set = "Data set") %>%
flextable::compose(part = "header", j = "Df", value = as_paragraph("Df")) %>%
flextable::compose(part = "header", j = "F", value = as_paragraph("Pseudo-F")) %>%
flextable::compose(part = "header", j = "p.value", value = as_paragraph(as_i("p"), "-value")) %>%
autofit() %>%
font(fontname = "Times New Roman", part = "all") %>%
fontsize(size = 12, part = "all") %>%
bold(part = "header") %>%
colformat_num(j = 'Df', digits = 2) %>%
colformat_num(j = "F", digits = 2) %>%
colformat_num(j = "p.value", digits = 4, na_str = "ns") %>%
align_nottext_col(align = "center", header = TRUE, footer = TRUE) %>%
align(align = "center", j = "p.value")
distPermTab <- distPerm %>%
rename("p.value" = "Pr(>F)") %>%
mutate_if(is.numeric, round, digits = 3) %>%
mutate(p.value = replace(p.value, p.value >= 0.05, "ns")) %>%
mutate(p.value = replace(p.value, p.value < 0.001, "< 0.001")) %>%
mutate_if(is.character, str_replace_all, pattern = "-", replacement = "–") %>%
flextable() %>%
set_header_labels(Data.set = "Data set") %>%
flextable::compose(part = "header", j = "Df", value = as_paragraph("Df")) %>%
flextable::compose(part = "header", j = "F", value = as_paragraph("Pseudo-F")) %>%
flextable::compose(part = "header", j = "p.value", value = as_paragraph(as_i("p"), "-value")) %>%
autofit() %>%
font(fontname = "Times New Roman", part = "all") %>%
fontsize(size = 12, part = "all") %>%
bold(part = "header") %>%
colformat_num(j = 'Df', digits = 2) %>%
colformat_num(j = "F", digits = 2) %>%
colformat_num(j = "p.value", digits = 4, na_str = "ns") %>%
align_nottext_col(align = "center", header = TRUE, footer = TRUE) %>%
align(align = "center", j = "p.value")
vpiDoc = read_docx()
vpiDoc = body_add_flextable(vpiDoc, value = distPermTab)
distPermTab <- distPerm %>%
rename("p.value" = "Pr(>F)") %>%
mutate_if(is.numeric, round, digits = 3) %>%
mutate(p.value = replace(p.value, p.value >= 0.05, "ns")) %>%
mutate(p.value = replace(p.value, p.value < 0.001, "< 0.001")) %>%
mutate_if(is.character, str_replace_all, pattern = "-", replacement = "–") %>%
flextable() %>%
set_header_labels(Data.set = "Data set") %>%
flextable::compose(part = "header", j = "Df", value = as_paragraph("Df")) %>%
flextable::compose(part = "header", j = "F", value = as_paragraph("Pseudo-F")) %>%
flextable::compose(part = "header", j = "p.value", value = as_paragraph(as_i("p"), "-value")) %>%
autofit() %>%
font(fontname = "Times New Roman", part = "all") %>%
fontsize(size = 12, part = "all") %>%
bold(part = "header") %>%
colformat_num(j = 'Df', digits = 2) %>%
colformat_num(j = "F", digits = 2) %>%
colformat_num(j = "p.value", digits = 4, na_str = "ns") %>%
align_nottext_col(align = "center", header = TRUE, footer = TRUE) %>%
align(align = "center", j = "p.value")
vpiDoc = read_docx()
vpiDoc = body_add_flextable(vpiDoc, value = distPermTab)
print(vpiDoc, target = "../tables/vpiTable.docx")
distPermTab
print(distPermTab)
distPermTab <- distPerm %>%
rename("p.value" = "Pr(>F)") %>%
mutate_if(is.numeric, round, digits = 3) %>%
mutate(p.value = replace(p.value, p.value >= 0.05, "ns")) %>%
mutate(p.value = replace(p.value, p.value < 0.001, "< 0.001")) %>%
mutate_if(is.character, str_replace_all, pattern = "-", replacement = "–") %>%
flextable() %>%
set_header_labels(Data.set = "Data set") %>%
flextable::compose(part = "header", j = "Df", value = as_paragraph("Df")) %>%
flextable::compose(part = "header", j = "SumOfSqs", value = as_paragraph("Sume of Squares")) %>%
flextable::compose(part = 'header', j = "R2", value = as_paragraph("R"), as_sup("2")) %>%
flextable::compose(part = "header", j = "F", value = as_paragraph("Pseudo-F")) %>%
flextable::compose(part = "header", j = "p.value", value = as_paragraph(as_i("p"), "-value")) %>%
autofit() %>%
font(fontname = "Times New Roman", part = "all") %>%
fontsize(size = 12, part = "all") %>%
bold(part = "header") %>%
colformat_num(j = 'Df', digits = 2) %>%
colformat_num(j = "F", digits = 2) %>%
colformat_num(j = "p.value", digits = 4, na_str = "ns") %>%
align_nottext_col(align = "center", header = TRUE, footer = TRUE) %>%
align(align = "center", j = "p.value")
distPermTab <- distPerm %>%
rename("p.value" = "Pr(>F)") %>%
mutate_if(is.numeric, round, digits = 3) %>%
mutate(p.value = replace(p.value, p.value >= 0.05, "ns")) %>%
mutate(p.value = replace(p.value, p.value < 0.001, "< 0.001")) %>%
mutate_if(is.character, str_replace_all, pattern = "-", replacement = "–") %>%
flextable() %>%
set_header_labels(Data.set = "Data set") %>%
flextable::compose(part = "header", j = "Df", value = as_paragraph("Df")) %>%
flextable::compose(part = "header", j = "SumOfSqs", value = as_paragraph("Sume of Squares")) %>%
flextable::compose(part = 'header', j = "R2", value = as_paragraph("R", as_sup("2"))) %>%
flextable::compose(part = "header", j = "F", value = as_paragraph("Pseudo-F")) %>%
flextable::compose(part = "header", j = "p.value", value = as_paragraph(as_i("p"), "-value")) %>%
autofit() %>%
font(fontname = "Times New Roman", part = "all") %>%
fontsize(size = 12, part = "all") %>%
bold(part = "header") %>%
colformat_num(j = 'Df', digits = 2) %>%
colformat_num(j = "F", digits = 2) %>%
colformat_num(j = "p.value", digits = 4, na_str = "ns") %>%
align_nottext_col(align = "center", header = TRUE, footer = TRUE) %>%
align(align = "center", j = "p.value")
print(distPermTab)
vpiDoc = read_docx()
vpiDoc = body_add_flextable(vpiDoc, value = distPermTab)
print(vpiDoc, target = "../tables/vpiTable.docx")
vpiDoc = read_docx()
vpiDoc = body_add_flextable(vpiDoc, value = distPermTab)
print(vpiDoc, target = "../tables/vpiTable.docx")
distPermTab
distPermTab <- distPerm %>%
rename("p.value" = "Pr(>F)") %>%
mutate_if(is.numeric, round, digits = 3) %>%
mutate(p.value = replace(p.value, p.value >= 0.05, "ns")) %>%
mutate(p.value = replace(p.value, p.value < 0.001, "< 0.001")) %>%
mutate_if(is.character, str_replace_all, pattern = "-", replacement = "–") %>%
flextable() %>%
set_header_labels(Data.set = "Data set") %>%
flextable::compose(part = "header", j = "Df", value = as_paragraph("Df")) %>%
flextable::compose(part = "header", j = "SumOfSqs", value = as_paragraph("Sum of Squares")) %>%
flextable::compose(part = 'header', j = "R2", value = as_paragraph("R", as_sup("2"))) %>%
flextable::compose(part = "header", j = "F", value = as_paragraph("Pseudo-F")) %>%
flextable::compose(part = "header", j = "p.value", value = as_paragraph(as_i("p"), "-value")) %>%
autofit() %>%
font(fontname = "Times New Roman", part = "all") %>%
fontsize(size = 12, part = "all") %>%
bold(part = "header") %>%
colformat_num(j = 'Df', digits = 2) %>%
colformat_num(j = "F", digits = 2) %>%
colformat_num(j = "p.value", digits = 4, na_str = "ns") %>%
align_nottext_col(align = "center", header = TRUE, footer = TRUE) %>%
align(align = "center", j = "p.value")
vpiDoc = read_docx()
vpiDoc = body_add_flextable(vpiDoc, value = distPermTab)
print(vpiDoc, target = "../tables/vpiTable.docx")
vpiDoc = read_docx()
vpiDoc = body_add_flextable(vpiDoc, value = distPermTab)
print(vpiDoc, target = "../tables/vpiTable.docx")
distPermTab
comboPlot <- acerStack+apalStack
ACER <- vpiData2 %>%
filter(species == "ACER") %>%
filter(abundance > 1) %>%
droplevels()
APAL <- vpiData2 %>%
filter(species == "APAL") %>%
filter(abundance > 1) %>%
droplevels()
acerStack1 <- ggplot(ACER, aes(x = timePoint, y = abundance))+
geom_bar(aes(fill = factor(class)), position = position_stack(reverse = TRUE), stat = 'identity', color = 'black', alpha = 0.8)+
ylim(0,100)+
labs(y = "Relative Abundance (%)", fill = "Class", title = "Relative Species Abundance > 1%", x = "Time Point")+
scale_x_discrete(labels = c("Baseline", "12 Month"))+
scale_y_reverse()+
facet_wrap(.~Site, scales = 'free')
acerStack <- acerStack1 +theme(
axis.text.x = element_text(size = 15, colour = "black", vjust = 0.5, hjust = 0.5, face= "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 40, face = "bold"),
axis.text.y = element_text(colour = "black", size = 30, face = "bold"),
legend.title = element_text(size = 40, face = "bold"),
legend.text = element_text(size = 36, face = "bold", colour = "black"),
panel.grid.major = element_line(size = 0.5, linetype = 'solid', colour = "white"),
panel.background = element_rect(fill = '#F5F5F5'),
plot.title = element_text(size = 40, face = "bold"),
axis.line = element_line(colour = "black"),
axis.ticks = element_line(color="black"),
text = element_text(size=40, color="black"),
legend.position = "right")
acerStack
apalStack1 <- ggplot(APAL, aes(x = timePoint, y = abundance))+
geom_bar(aes(fill = factor(class)), position = position_stack(reverse = TRUE), stat = 'identity', color = 'black', alpha = 0.8)+
ylim(0,100)+
labs(y = "Relative Abundance (%)", fill = "Class", title = "Relative Species Abundance > 1%", x = "Time Point")+
scale_x_discrete(labels = c("Baseline", "12 Month"))+
scale_y_reverse()+
facet_wrap(.~Site, scales = 'free')
apalStack <- apalStack1 +theme(
axis.text.x = element_text(size = 15, colour = "black", vjust = 0.5, hjust = 0.5, face= "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 40, face = "bold"),
axis.text.y = element_text(colour = "black", size = 30, face = "bold"),
legend.title = element_text(size = 40, face = "bold"),
legend.text = element_text(size = 36, face = "bold", colour = "black"),
panel.grid.major = element_line(size = 0.5, linetype = 'solid', colour = "white"),
panel.background = element_rect(fill = '#F5F5F5'),
plot.title = element_text(size = 40, face = "bold"),
axis.line = element_line(colour = "black"),
axis.ticks = element_line(color="black"),
text = element_text(size=40, color="black"),
legend.position = "right")
apalStack
comboPlot <- acerStack+apalStack
comboPlot <- acerStack+apalStack
comboPlot <- acerStack+apalStack
comboPlot
ggsave("../figures/comboPlot.png", plot = comboPlot, width = 20, height = 15, units = 'in', dpi = 600)
comboPlot <- acerStack/apalStack
comboPlot
apalStack
comboPlot <- acerStack/apalStack
comboPlot
comboPlot <- acerStack/apalStack + plot_layout(guides = 'collect')
comboPlot
