filter(class != "Review") %>%
summarise(count = sum(count)) %>%
group_by(Date, Site) %>%
mutate(totalObservations = sum(count, na.rm = TRUE))
levels(vpiData$Site)
vpiData$class <- gsub("Crustose coralline algae natans","Crustose coralline algae",vpiData$class)
vpiData$class <- gsub("Rubble", "Bare Substrate", vpiData$class)
vpiData$class <- as.factor(vpiData$class)
vpiData$Site <- as.factor(vpiData$Site)
levels(vpiData$Site)
edr <- vpiData %>%
select(Date, Site, Plot, Marker, class, count) %>%
filter(Site == c("T-13a", "T-12a", "T-AP-3a", "T-13b", "T-12b", "T-AP-3b"))
edr <- vpiData %>%
dplyr::select(Date, Site, Plot, Marker, class, count) %>%
dplyr::filter(Site == c("T-13a", "T-12a", "T-AP-3a", "T-13b", "T-12b", "T-AP-3b"))
knitr::opts_chunk$set(warning = FALSE, fig.align = 'left')
library(magrittr)
if (!require("pacman")) install.packages("pacman")
pacman::p_load("ggplot2","officer","ggpubr", "rcompanion", "RColorBrewer", "patchwork", "magrittr","reshape2", "stringr", "plyr", "dplyr", "flextable", "tidyr", "tibble", "vegan", "forcats", "readr", "metafolio", "FSA","viridis", "paletteer", "purrr")
pacman::p_load_gh("pmartinezarbizu/pairwiseAdonis/pairwiseAdonis")
read_plus <- function(flnm) {
read_csv(flnm) %>%
mutate(filename = flnm)
}
vpiData1 <-
list.files(path = "../data/vpiData", pattern = "*.csv",
full.names = T) %>%
map_df(~read_plus(.))
#Sort out data to have proper columns for all the info i want, this might need to be changed to figure out the Marks vs Plot thing
vpiData <- vpiData1 %>%
tidyr::separate(filename, into=c("Date", "Site"),extra = 'merge',sep = "(?=T)") %>%
tidyr::separate(Date, into=c("remove", "Date"),sep = "../data/vpiData/") %>%
tidyr::separate(Site, into = c("Site", "delete"),sep = ".pqs") %>%
dplyr::select(-c(remove, delete)) %>%
mutate_if(is.character, str_replace_all, pattern = "_", replacement = "-") %>%
tidyr::separate(Date, into = c("Date", "remove"), sep = 10) %>%
dplyr::select(-remove) %>%
tidyr::separate(Site, into = c("Site", "Plot"), sep = "(?=plot)", extra = "merge") %>%
tidyr::separate(Site, into = c("Site", "Marker"), sep = "(?=mark)", extra = "merge") %>%
tidyr::separate(Plot, into = c("Plot", "Marker"), sep = "(?=mark)", extra = "merge" ) %>%
dplyr::rename(abundance = `%`) %>%
tidyr::drop_na(abundance) %>%
arrange(desc(abundance))
#Changing the Date to factors
vpiData$Date<-as.factor(vpiData$Date)
vpiData$Date<-strptime(vpiData$Date,format="%Y-%m-%d") #defining what is the original format of your date
vpiData$Date<-as.Date.factor(vpiData$Date,format="%Y-%m-%d")
#Making some corrections in the naming
vpiData$class <- gsub("Crustose coralline algae natans","Crustose coralline algae",vpiData$class)
vpiData$class <- gsub("Rubble", "Bare Substrate", vpiData$class)
vpiData$class <- as.factor(vpiData$class)
vpiData$Site <- as.factor(vpiData$Site)
knitr::opts_chunk$set(warning = FALSE, fig.align = 'left')
library(magrittr)
if (!require("pacman")) install.packages("pacman")
pacman::p_load("ggplot2","officer","ggpubr", "rcompanion", "RColorBrewer", "patchwork", "magrittr","reshape2", "stringr", "plyr", "dplyr", "flextable", "tidyr", "tibble", "vegan", "forcats", "readr", "metafolio", "FSA","viridis", "paletteer", "purrr")
pacman::p_load_gh("pmartinezarbizu/pairwiseAdonis/pairwiseAdonis")
read_plus <- function(flnm) {
read_csv(flnm) %>%
mutate(filename = flnm)
}
vpiData1 <-
list.files(path = "../data/vpiData", pattern = "*.csv",
full.names = T) %>%
map_df(~read_plus(.))
#Sort out data to have proper columns for all the info i want, this might need to be changed to figure out the Marks vs Plot thing
vpiData <- vpiData1 %>%
tidyr::separate(filename, into=c("Date", "Site"),extra = 'merge',sep = "(?=T)") %>%
tidyr::separate(Date, into=c("remove", "Date"),sep = "../data/vpiData/") %>%
tidyr::separate(Site, into = c("Site", "delete"),sep = ".pqs") %>%
dplyr::select(-c(remove, delete)) %>%
mutate_if(is.character, str_replace_all, pattern = "_", replacement = "-") %>%
tidyr::separate(Date, into = c("Date", "remove"), sep = 10) %>%
dplyr::select(-remove) %>%
tidyr::separate(Site, into = c("Site", "Plot"), sep = "(?=plot)", extra = "merge") %>%
tidyr::separate(Site, into = c("Site", "Marker"), sep = "(?=mark)", extra = "merge") %>%
tidyr::separate(Plot, into = c("Plot", "Marker"), sep = "(?=mark)", extra = "merge" ) %>%
dplyr::rename(abundance = `%`) %>%
tidyr::drop_na(abundance) %>%
arrange(desc(abundance))
#Changing the Date to factors
vpiData$Date<-as.factor(vpiData$Date)
vpiData$Date<-strptime(vpiData$Date,format="%Y-%m-%d") #defining what is the original format of your date
vpiData$Date<-as.Date.factor(vpiData$Date,format="%Y-%m-%d")
#Making some corrections in the naming
vpiData$class <- gsub("Crustose coralline algae natans","Crustose coralline algae",vpiData$class)
vpiData$class <- gsub("Rubble", "Bare Substrate", vpiData$class)
vpiData$class <- as.factor(vpiData$class)
vpiData$Site <- as.factor(vpiData$Site)
View(vpiData)
edr <- vpiData %>%
dplyr::select(Date, Site, Plot, Marker, class, count) %>%
dplyr::filter(Site == c("T-13a", "T-12a", "T-AP-3a", "T-13b", "T-12b", "T-AP-3b"))
View(edr)
levels(vpiData$Site)
edr <- vpiData %>%
dplyr::select(Date, Site, Plot, Marker, class, count) %>%
dplyr::filter(Site %in% c("T-13a", "T-12a", "T-AP-3a", "T-13b", "T-12b", "T-AP-3b"))
edr_2p1 <- edr %>%
select(Date, Site, Plot, Marker, class, count) %>%
group_by(Date, Site, class) %>%
filter(class != "Review") %>%
summarise(count = sum(count)) %>%
group_by(Date, Site) %>%
mutate(totalObservations = sum(count, na.rm = TRUE)) %>%
group_by(Date, Site, class) %>%
summarise(abundance = count/totalObservations)
View(edr_2p1)
edr_2p1 <- edr %>%
select(Date, Site, Plot, Marker, class, count) %>%
group_by(Date, Site, class) %>%
filter(class != "Review") %>%
summarise(count = sum(count))
edr_2p1 <- edr %>%
select(Date, Site, Plot, Marker, class, count) %>%
group_by(Date, Site, class) %>%
filter(class != "Review") %>%
summarise(count = sum(count)) %>%
group_by(Date, Site)
edr_2p1 <- edr %>%
select(Date, Site, Plot, Marker, class, count) %>%
group_by(Date, Site, class) %>%
filter(class != "Review") %>%
summarise(count = sum(count)) %>%
group_by(Date, Site) %>%
mutate(totalObservations = sum(count, na.rm = TRUE))
edr_2p1 <- edr %>%
select(Date, Site, Plot, Marker, class, count) %>%
group_by(Date, Site, class) %>%
filter(class != "Review") %>%
summarise(count = sum(count)) %>%
group_by(Date, Site) %>%
mutate(totalObservations = sum(count, na.rm = TRUE)) %>%
group_by(Date, Site, class) %>%
summarise(abundance = ((count/totalObservations)*100))
edr_2p1 <- edr %>%
filter(abundance > 0.5) %>%
droplevels()
edr_2p <- edr_2p1 %>%
filter(abundance > 0.5) %>%
droplevels()
edrStack1 <- ggplot(edr_2p, aes(x = as.factor(Date), y = abundance))+
geom_bar(aes(fill = class), position = position_fill(reverse = TRUE), stat = 'identity', color = "black")+
# scale_fill_manual(values = myColors)+
facet_wrap(~ Site, scales = 'free')
edrStack1
knitr::opts_chunk$set(warning = FALSE, fig.align = 'left')
library(magrittr)
if (!require("pacman")) install.packages("pacman")
pacman::p_load("ggplot2","officer","ggpubr", "rcompanion", "RColorBrewer", "patchwork", "magrittr","reshape2", "stringr", "plyr", "dplyr", "flextable", "tidyr", "tibble", "vegan", "forcats", "readr", "metafolio", "FSA","viridis", "paletteer", "purrr")
pacman::p_load_gh("pmartinezarbizu/pairwiseAdonis/pairwiseAdonis")
?magrittr
read_plus <- function(flnm) {
read_csv(flnm) %>%
mutate(filename = flnm)
}
vpiData1 <-
list.files(path = "../data/vpiData", pattern = "*.csv",
full.names = T) %>%
map_df(~read_plus(.))
#Sort out data to have proper columns for all the info i want, this might need to be changed to figure out the Marks vs Plot thing
vpiData <- vpiData1 %>%
tidyr::separate(filename, into=c("Date", "Site"),extra = 'merge',sep = "(?=T)") %>%
tidyr::separate(Date, into=c("remove", "Date"),sep = "../data/vpiData/") %>%
tidyr::separate(Site, into = c("Site", "delete"),sep = ".pqs") %>%
dplyr::select(-c(remove, delete)) %>%
mutate_if(is.character, str_replace_all, pattern = "_", replacement = "-") %>%
tidyr::separate(Date, into = c("Date", "remove"), sep = 10) %>%
dplyr::select(-remove) %>%
tidyr::separate(Site, into = c("Site", "Plot"), sep = "(?=plot)", extra = "merge") %>%
tidyr::separate(Site, into = c("Site", "Marker"), sep = "(?=mark)", extra = "merge") %>%
tidyr::separate(Plot, into = c("Plot", "Marker"), sep = "(?=mark)", extra = "merge" ) %>%
dplyr::rename(abundance = `%`) %>%
tidyr::drop_na(abundance) %>%
arrange(desc(abundance))
#Changing the Date to factors
vpiData$Date<-as.factor(vpiData$Date)
vpiData$Date<-strptime(vpiData$Date,format="%Y-%m-%d") #defining what is the original format of your date
vpiData$Date<-as.Date.factor(vpiData$Date,format="%Y-%m-%d")
#Making some corrections in the naming
vpiData$class <- gsub("Crustose coralline algae natans","Crustose coralline algae",vpiData$class)
vpiData$class <- gsub("Rubble", "Bare Substrate", vpiData$class)
vpiData$class <- as.factor(vpiData$class)
vpiData$Site <- as.factor(vpiData$Site)
edr <- vpiData %>%
dplyr::select(Date, Site, Plot, Marker, class, count) %>%
dplyr::filter(Site %in% c("T-13a", "T-12a", "T-AP-3a", "T-13b", "T-12b", "T-AP-3b"))
knitr::opts_chunk$set(warning = FALSE, fig.align = 'left')
library(magrittr)
if (!require("pacman")) install.packages("pacman")
pacman::p_load("ggplot2","officer","ggpubr", "rcompanion", "RColorBrewer", "patchwork", "magrittr","reshape2", "stringr", "plyr", "dplyr", "flextable", "tidyr", "tibble", "vegan", "forcats", "readr", "metafolio", "FSA","viridis", "paletteer", "purrr")
pacman::p_load_gh("pmartinezarbizu/pairwiseAdonis/pairwiseAdonis")
read_plus <- function(flnm) {
read_csv(flnm) %>%
mutate(filename = flnm)
}
vpiData1 <-
list.files(path = "../data/vpiData", pattern = "*.csv",
full.names = T) %>%
map_df(~read_plus(.))
#Sort out data to have proper columns for all the info i want, this might need to be changed to figure out the Marks vs Plot thing
vpiData <- vpiData1 %>%
tidyr::separate(filename, into=c("Date", "Site"),extra = 'merge',sep = "(?=T)") %>%
tidyr::separate(Date, into=c("remove", "Date"),sep = "../data/vpiData/") %>%
tidyr::separate(Site, into = c("Site", "delete"),sep = ".pqs") %>%
dplyr::select(-c(remove, delete)) %>%
mutate_if(is.character, str_replace_all, pattern = "_", replacement = "-") %>%
tidyr::separate(Date, into = c("Date", "remove"), sep = 10) %>%
dplyr::select(-remove) %>%
tidyr::separate(Site, into = c("Site", "Plot"), sep = "(?=plot)", extra = "merge") %>%
tidyr::separate(Site, into = c("Site", "Marker"), sep = "(?=mark)", extra = "merge") %>%
tidyr::separate(Plot, into = c("Plot", "Marker"), sep = "(?=mark)", extra = "merge" ) %>%
dplyr::rename(abundance = `%`) %>%
tidyr::drop_na(abundance) %>%
arrange(desc(abundance))
#Changing the Date to factors
vpiData$Date<-as.factor(vpiData$Date)
vpiData$Date<-strptime(vpiData$Date,format="%Y-%m-%d") #defining what is the original format of your date
vpiData$Date<-as.Date.factor(vpiData$Date,format="%Y-%m-%d")
#Making some corrections in the naming
vpiData$class <- gsub("Crustose coralline algae natans","Crustose coralline algae",vpiData$class)
vpiData$class <- gsub("Rubble", "Bare Substrate", vpiData$class)
vpiData$class <- as.factor(vpiData$class)
vpiData$Site <- as.factor(vpiData$Site)
edr <- vpiData %>%
dplyr::select(Date, Site, Plot, Marker, class, count) %>%
dplyr::filter(Site %in% c("T-13a", "T-12a", "T-AP-3a", "T-13b", "T-12b", "T-AP-3b"))
edr_2p1 <- edr %>%
select(Date, Site, Plot, Marker, class, count) %>%
group_by(Date, Site, class) %>%
filter(class != "Review") %>%
summarise(count = sum(count)) %>%
group_by(Date, Site) %>%
mutate(totalObservations = sum(count, na.rm = TRUE)) %>%
group_by(Date, Site, class) %>%
summarise(abundance = ((count/totalObservations)*100))
edr_2p <- edr_2p1 %>%
filter(abundance > 0.5) %>%
droplevels()
edr_2p$Date <- as.factor(edr_2p$Date)
edr_2p$Date <- droplevels(edr_2p$Date)
edr_2p$Date <- as.Date.factor(edr_2p$Date)
myColors <- gg_color_hue(length(edr_2p$class), c = 50)
edrStack1 <- ggplot(edr_2p, aes(x = as.factor(Date), y = abundance))+
geom_bar(aes(fill = class), position = position_fill(reverse = TRUE), stat = 'identity', color = "black")+
# scale_fill_manual(values = myColors)+
facet_wrap(~ Site, scales = 'free')
edrStack <- edrStack1+theme(
axis.text.x = element_text(size = 40, colour = "black", vjust = 0.5, hjust = 0.5, face= "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 40, face = "bold"),
axis.text.y = element_text(colour = "black", size = 40, face = "bold"),
legend.title = element_text(size = 40, face = "bold"),
legend.text = element_text(size = 36, face = "bold", colour = "black"),
panel.grid.major = element_line(size = 0.5, linetype = 'solid', colour = "white"),
panel.background = element_rect(fill = '#F5F5F5'),
plot.title = element_text(size = 40, face = "bold"),
axis.line = element_line(colour = "black"),
axis.ticks = element_line(color="black"),
text = element_text(size=40, color="black"),
legend.position = "right")
edrStack
edrStack
edrStack <- edrStack1+theme(
axis.text.x = element_text(size = 40, colour = "black", vjust = 0.5, hjust = 0.5, angle = 45, face= "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 40, face = "bold"),
axis.text.y = element_text(colour = "black", size = 40, face = "bold"),
legend.title = element_text(size = 40, face = "bold"),
legend.text = element_text(size = 36, face = "bold", colour = "black"),
panel.grid.major = element_line(size = 0.5, linetype = 'solid', colour = "white"),
panel.background = element_rect(fill = '#F5F5F5'),
plot.title = element_text(size = 40, face = "bold"),
axis.line = element_line(colour = "black"),
axis.ticks = element_line(color="black"),
text = element_text(size=40, color="black"),
legend.position = "right")
edrStack
edrStack
edrStack <- edrStack1+theme(
axis.text.x = element_text(size = 40, colour = "black", vjust = 0.5, hjust = 1, angle = 45, face= "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 40, face = "bold"),
axis.text.y = element_text(colour = "black", size = 40, face = "bold"),
legend.title = element_text(size = 40, face = "bold"),
legend.text = element_text(size = 36, face = "bold", colour = "black"),
panel.grid.major = element_line(size = 0.5, linetype = 'solid', colour = "white"),
panel.background = element_rect(fill = '#F5F5F5'),
plot.title = element_text(size = 40, face = "bold"),
axis.line = element_line(colour = "black"),
axis.ticks = element_line(color="black"),
text = element_text(size=40, color="black"),
legend.position = "right")
edrStack
edrStack
edrStack <- edrStack1+theme(
axis.text.x = element_text(size = 40, colour = "black", vjust = 0.5, hjust = 0.25, angle = 45, face= "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 40, face = "bold"),
axis.text.y = element_text(colour = "black", size = 40, face = "bold"),
legend.title = element_text(size = 40, face = "bold"),
legend.text = element_text(size = 36, face = "bold", colour = "black"),
panel.grid.major = element_line(size = 0.5, linetype = 'solid', colour = "white"),
panel.background = element_rect(fill = '#F5F5F5'),
plot.title = element_text(size = 40, face = "bold"),
axis.line = element_line(colour = "black"),
axis.ticks = element_line(color="black"),
text = element_text(size=40, color="black"),
legend.position = "right")
edrStack
legend.position = "right")
edrStack
edrStack <- edrStack1+theme(
axis.text.x = element_text(size = 40, colour = "black", vjust = 0.25, hjust = 0.5, angle = 45, face= "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 40, face = "bold"),
axis.text.y = element_text(colour = "black", size = 40, face = "bold"),
legend.title = element_text(size = 40, face = "bold"),
legend.text = element_text(size = 36, face = "bold", colour = "black"),
panel.grid.major = element_line(size = 0.5, linetype = 'solid', colour = "white"),
panel.background = element_rect(fill = '#F5F5F5'),
plot.title = element_text(size = 40, face = "bold"),
axis.line = element_line(colour = "black"),
axis.ticks = element_line(color="black"),
text = element_text(size=40, color="black"),
legend.position = "right")
edrStack
edrStack
x scale discreet
?x_scale_discrete
edrStack1 <- ggplot(edr_2p, aes(x = as.factor(Date), y = abundance))+
geom_bar(aes(fill = class), position = position_fill(reverse = TRUE), stat = 'identity', color = "black")+
# scale_fill_manual(values = myColors)+
scale_x_discrete(labels = ("T0", "T12"))+
edrStack1 <- ggplot(edr_2p, aes(x = as.factor(Date), y = abundance))+
geom_bar(aes(fill = class), position = position_fill(reverse = TRUE), stat = 'identity', color = "black")+
# scale_fill_manual(values = myColors)+
scale_x_discrete(labels = c("T0", "T12"))+
facet_wrap(~ Site, scales = 'free')
edrStack <- edrStack1+theme(
axis.text.x = element_text(size = 40, colour = "black", vjust = 0.25, hjust = 0.5, angle = 45, face= "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 40, face = "bold"),
axis.text.y = element_text(colour = "black", size = 40, face = "bold"),
legend.title = element_text(size = 40, face = "bold"),
legend.text = element_text(size = 36, face = "bold", colour = "black"),
panel.grid.major = element_line(size = 0.5, linetype = 'solid', colour = "white"),
panel.background = element_rect(fill = '#F5F5F5'),
plot.title = element_text(size = 40, face = "bold"),
axis.line = element_line(colour = "black"),
axis.ticks = element_line(color="black"),
text = element_text(size=40, color="black"),
legend.position = "right")
edrStack
edrStack
edrStack <- edrStack1+theme(
axis.text.x = element_text(size = 40, colour = "black", vjust = 0.5, hjust = 0.5,face= "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 40, face = "bold"),
axis.text.y = element_text(colour = "black", size = 40, face = "bold"),
legend.title = element_text(size = 40, face = "bold"),
legend.text = element_text(size = 36, face = "bold", colour = "black"),
panel.grid.major = element_line(size = 0.5, linetype = 'solid', colour = "white"),
panel.background = element_rect(fill = '#F5F5F5'),
plot.title = element_text(size = 40, face = "bold"),
axis.line = element_line(colour = "black"),
axis.ticks = element_line(color="black"),
text = element_text(size=40, color="black"),
legend.position = "right")
edrStack
edrStack1 <- ggplot(edr_2p, aes(x = as.factor(Date), y = fct_reorder(species, abundance)))+
geom_bar(aes(fill = class), position = position_fill(reverse = TRUE), stat = 'identity', color = "black")+
# scale_fill_manual(values = myColors)+
scale_x_discrete(labels = c("T0", "T12"))+
facet_wrap(~ Site, scales = 'free')
edrStack <- edrStack1+theme(
axis.text.x = element_text(size = 40, colour = "black", vjust = 0.5, hjust = 0.5,face= "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 40, face = "bold"),
axis.text.y = element_text(colour = "black", size = 40, face = "bold"),
legend.title = element_text(size = 40, face = "bold"),
legend.text = element_text(size = 36, face = "bold", colour = "black"),
panel.grid.major = element_line(size = 0.5, linetype = 'solid', colour = "white"),
panel.background = element_rect(fill = '#F5F5F5'),
plot.title = element_text(size = 40, face = "bold"),
axis.line = element_line(colour = "black"),
axis.ticks = element_line(color="black"),
text = element_text(size=40, color="black"),
legend.position = "right")
edrStack
edrStack1 <- ggplot(edr_2p, aes(x = as.factor(Date), y = fct_reorder(class, abundance)))+
geom_bar(aes(fill = class), position = position_fill(reverse = TRUE), stat = 'identity', color = "black")+
# scale_fill_manual(values = myColors)+
scale_x_discrete(labels = c("T0", "T12"))+
facet_wrap(~ Site, scales = 'free')
edrStack
edrStack1 <- ggplot(edr_2p, aes(x = as.factor(Date), y = fct_reorder(class, abundance)))+
geom_bar(aes(fill = class), position = position_fill(reverse = TRUE), stat = 'identity', color = "black")+
# scale_fill_manual(values = myColors)+
scale_x_discrete(labels = c("T0", "T12"))+
facet_wrap(~ Site, scales = 'free')
edrStack <- edrStack1+theme(
axis.text.x = element_text(size = 40, colour = "black", vjust = 0.5, hjust = 0.5,face= "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 40, face = "bold"),
axis.text.y = element_text(colour = "black", size = 40, face = "bold"),
legend.title = element_text(size = 40, face = "bold"),
legend.text = element_text(size = 36, face = "bold", colour = "black"),
panel.grid.major = element_line(size = 0.5, linetype = 'solid', colour = "white"),
panel.background = element_rect(fill = '#F5F5F5'),
plot.title = element_text(size = 40, face = "bold"),
axis.line = element_line(colour = "black"),
axis.ticks = element_line(color="black"),
text = element_text(size=40, color="black"),
legend.position = "right")
edrStack
edrStack
edrStack1 <- ggplot(edr_2p, aes(x = as.factor(Date), y = fct_reorder(class, abundance)))+
geom_bar(aes(fill = class), position = position_fill(reverse = TRUE), stat = 'identity', color = "black")+
# scale_fill_manual(values = myColors)+
scale_x_discrete(labels = c("T0", "T12"))+
facet_wrap(~ Site, scales = 'free')
edrStack1
?scale_y_reverse
edrStack1 <- ggplot(edr_2p, aes(x = as.factor(Date), y = fct_reorder(class, abundance)))+
geom_bar(aes(fill = class), position = position_fill(reverse = TRUE), stat = 'identity', color = "black")+
# scale_fill_manual(values = myColors)+
scale_x_discrete(labels = c("T0", "T12"))+
scale_y_reverse()+
facet_wrap(~ Site, scales = 'free')
edrStack1
levels(edr_2p$class)
levels(edr_2p$class, desc(edr_2p$abundance))
?levels
class(edr_2p$class)
edr_2p[ , class := reorder(class, abundance)]
library(data.table)
edr_2p = data.table(edr_2p)
Data[ , edr_2p$class := redorder (edr_2p$class, edr_2p$abundance)]
edr_2p[ , class := reorder (class, abundance)]
edrStack1 <- ggplot(edr_2p, aes(x = as.factor(Date), y = fct_reorder(class, abundance)))+
geom_bar(aes(fill = class), position = position_fill(reverse = TRUE), stat = 'identity', color = "black")+
# scale_fill_manual(values = myColors)+
scale_x_discrete(labels = c("T0", "T12"))+
scale_y_reverse()+
facet_wrap(~ Site, scales = 'free')
edrStack1 <- ggplot(edr_2p, aes(x = as.factor(Date), y = abundance))+
geom_bar(aes(fill = class), position = position_fill(reverse = TRUE), stat = 'identity', color = "black")+
# scale_fill_manual(values = myColors)+
scale_x_discrete(labels = c("T0", "T12"))+
scale_y_reverse()+
facet_wrap(~ Site, scales = 'free')
edrStack1
levels(edr_2p$class)
if (!require("pacman")) install.packages("pacman")
pacman::p_load("ggplot2","officer","ggpubr", "rcompanion", "RColorBrewer", "patchwork", "magrittr","reshape2", "stringr", "plyr", "dplyr", "flextable", "tidyr", "tibble", "vegan", "forcats", "readr", "metafolio", "FSA","viridis", "paletteer", "data.table")
pacman::p_load_gh("pmartinezarbizu/pairwiseAdonis/pairwiseAdonis")
edr_2p1 <- edr %>%
select(Date, Site, Plot, Marker, class, count) %>%
group_by(Date, Site, class) %>%
filter(class != "Review") %>%
summarise(count = sum(count)) %>%
group_by(Date, Site) %>%
mutate(totalObservations = sum(count, na.rm = TRUE)) %>%
group_by(Date, Site, class) %>%
summarise(abundance = ((count/totalObservations)*100))
edr_2p <- edr_2p1 %>%
filter(abundance > 0.5) %>%
droplevels()
#reordering factor levels so they're ranked by abundance levels using the package "data table"
edr_2p = data.table(edr_2p)
edr_2p[, class := reorder(class, abundance)]
edr_2p$Date <- as.factor(edr_2p$Date)
edr_2p$Date <- droplevels(edr_2p$Date)
edr_2p$Date <- as.Date.factor(edr_2p$Date)
myColors <- gg_color_hue(length(edr_2p$class), c = 50)
edrStack1 <- ggplot(edr_2p, aes(x = as.factor(Date), y = abundance))+
geom_bar(aes(fill = class), position = position_fill(reverse = TRUE), stat = 'identity', color = "black")+
# scale_fill_manual(values = myColors)+
scale_x_discrete(labels = c("T0", "T12"))+
scale_y_reverse()+
facet_wrap(~ Site, scales = 'free')
edrStack <- edrStack1+theme(
axis.text.x = element_text(size = 40, colour = "black", vjust = 0.5, hjust = 0.5,face= "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 40, face = "bold"),
axis.text.y = element_text(colour = "black", size = 40, face = "bold"),
legend.title = element_text(size = 40, face = "bold"),
legend.text = element_text(size = 36, face = "bold", colour = "black"),
panel.grid.major = element_line(size = 0.5, linetype = 'solid', colour = "white"),
panel.background = element_rect(fill = '#F5F5F5'),
plot.title = element_text(size = 40, face = "bold"),
axis.line = element_line(colour = "black"),
axis.ticks = element_line(color="black"),
text = element_text(size=40, color="black"),
legend.position = "right")
edrStack
edrStack
ggsave("../figures/plotCleaningStudyGraph.png", plot = edrStasck, width = 20, height = 35, units = 'in', dpi = 600)
ggsave("../figures/plotCleaningStudyGraph.png", plot = edrStack, width = 20, height = 35, units = 'in', dpi = 600)
ggsave("../figures/plotCleaningStudyGraph.png", plot = edrStack, width = 20, height = 20, units = 'in', dpi = 600)
knitr::opts_chunk$set(warning = FALSE, fig.align = 'left')
library(magrittr)
if (!require("pacman")) install.packages("pacman")
pacman::p_load("ggplot2","officer","ggpubr", "rcompanion", "RColorBrewer", "patchwork", "magrittr","reshape2", "stringr", "plyr", "dplyr", "flextable", "tidyr", "tibble", "vegan", "forcats", "readr", "metafolio", "FSA","viridis", "paletteer", "data.table")
pacman::p_load_gh("pmartinezarbizu/pairwiseAdonis/pairwiseAdonis")
?map_df
ggsave("../figures/plotCleaningStudyGraph.png", plot = edrStack, width = 20, height = 20, units = 'in', dpi = 600)
getwd()
list.files("../")
tinytex::install_tinytex()
